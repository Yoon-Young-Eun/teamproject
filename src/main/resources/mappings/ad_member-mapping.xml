<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="MemberDAO">


    <!-- 블랙회원 & 검색 조건 이후의 데이터 카운팅-->
	<select id="getArticleCount" resultType="int">
  	<![CDATA[ select count(*) from (select @rownum := @rownum+1 as rnum, customer_no, customer_name,customer_passwd, customer_id, customer_phone, customer_join_date, customer_sms_permit, customer_zipcode, customer_address1, customer_address2, customer_birth, customer_status from customer, (select @rownum :=0) as rowcolum where]]>
	
			<if test="searchCondition=='customer_id'">
    			<![CDATA[customer_id like concat('%', #{searchKeyword}, '%') and]]></if>
			<if test="searchCondition=='customer_address1'">	
    			<![CDATA[customer_address1 like concat('%', #{searchKeyword}, '%') and]]></if>
    <![CDATA[customer_status not in ('블랙회원') order by customer_no desc) as rownum_table  ]]>
	</select>
	

	<select id="getBoardList" resultType="customer">
		select * from customer
	</select>

	<select id="getMessageList" resultType="message">
		select * from message
	</select>

	<select id="getRead" parameterType="customer"
		resultType="customer">
		select * from customer where customer_no=#{customer_no}
	</select>



   <!-- 블랙회원 회원 조회 (검색기능 포함)-->
	<select id="getBlackList" parameterType="paging"
		resultType="customer">
    	     <![CDATA[ select * from (select @rownum := @rownum+1 as rnum, customer_no, customer_name,customer_passwd, customer_id, customer_phone, customer_join_date, customer_sms_permit, customer_zipcode, customer_address1, customer_address2, customer_birth, customer_status from customer, (select @rownum :=0) as rowcolum where]]>
			<if test="searchCondition=='customer_id'">
    			<![CDATA[customer_id like concat('%', #{searchKeyword}, '%') and]]></if>
			<if test="searchCondition=='customer_address1'">	
    			<![CDATA[customer_address1 like concat('%', #{searchKeyword}, '%') and]]></if>
    <![CDATA[customer_status = ('블랙회원') order by customer_no desc) as rownum_table where rnum >=#{startRow} and rnum <=#{endRow} ]]>
	</select>


    <!-- 블랙회원을 제외한 정상회원 조회 (검색기능 포함)-->
	<select id="getArticeList" parameterType="paging"
		resultType="customer">
  
    <![CDATA[ select * from (select @rownum := @rownum+1 as rnum, customer_no, customer_name,customer_passwd, customer_id, customer_phone, customer_join_date, customer_sms_permit, customer_zipcode, customer_address1, customer_address2, customer_birth, customer_status from customer, (select @rownum :=0) as rowcolum where ]]>
			<if test="searchCondition=='customer_address1'">
    			<![CDATA[customer_address1 like concat('%', #{searchKeyword}, '%') and]]></if>
			<if test="searchCondition=='customer_id'">	
    			<![CDATA[ customer_id like concat('%', #{searchKeyword}, '%') and]]></if>
    <![CDATA[customer_status not in ('블랙회원') order by customer_no desc) as rownum_table where rnum >=#{startRow} and rnum <=#{endRow} ]]>
	</select>


</mapper>



<!-- 	<select parameterType="cateSearchVO" resultType="categoryVO"
		id="getCategoryList"> 
	<![CDATA[select * from(select category_seq,category_name,category_num, @rownum:=@rownum+1 
	as rnum from category , (SELECT @rownum:=0) TMP ]]>
		<trim prefix="WHERE" prefixOverrides="AND |OR">
			<if test="name != null"><![CDATA[AND category_name 
	like CONCAT('%',#{name},'%')]]></if>
			<if test="num != 0">AND category_num=#{num}</if>
		</trim> <![CDATA[order by category_num) B where rnum>(#{page}-1)*5 AND rnum<=#{page}*5 
	order by category_num ]]>
	</select> -->












