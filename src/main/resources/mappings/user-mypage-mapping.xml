<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
 <mapper namespace = "MypageVO">
 	
 	<select id = "orderlist" parameterType = "customer" resultType="ORDER">
 		select * from order_cm where customer_no = #{customer_no}
 	</select>
 	
 	<select id = "recentorder" parameterType = "customer" resultType = "ORDER">
 		select * from order_cm where customer_no = #{customer_no} order by order_no desc limit 3; 
 	</select>
 	
 	<select id = "ordervo" parameterType = "customer" resultType="ORDER">
 		select * from order_cm where order_no = #{order_no}
 	</select>
 	
 	<select id = "orderdetail" parameterType = "ORDER" resultType ="orderManagement">
 		select * from order_management where order_no = #{order_no}
 	</select>
 	
 	<select id = "storedetail" parameterType = "ORDER" resultType = "store">
 		select * from store where store_code = #{store_code}
 	</select>
 
 	<select id = "addresslist" parameterType = "customer" resultType = "CM_ADDRESS">
 		select * from cm_address where customer_no = #{customer_no}
 	</select>
 	
 	<select id = "couponlist" parameterType = "customer" resultType = "CouponList">
 		select * from coupon_management where customer_no = #{customer_no}
 	</select>
 	
 	<select id = "asklist" parameterType = "customer" resultType = "QNA">
 		select * from board_qna_cm where customer_no = #{customer_no}
 	</select>
 	
 	<insert id="insertask" parameterType="QNA">
 		insert into board_qna_cm (board_qna_no, board_qna_type, board_qna_title, board_qna_content, customer_no)
 		values (#{board_qna_no}, #{board_qna_type}, #{board_qna_title}, #{board_qna_content}, #{customer_no})
 	</insert>
 	
 	<select id="myOrderCount" resultType="int">
 		select count(*) from order_cm
 	</select>
 	
 	<select id="myOrderPaging" parameterType="paging" resultType="order">
 	<![CDATA[select * from (select @rownum := @rownum+1 as rnum, order_no, order_type, store_code, order_date, order_pickup_date, order_pickup_time, cm_gate_passwd, order_request1, order_request2, order_price, order_use_coupon_price, order_status, order_price_status, order_price_method, customer_no, order_customer_name, order_store_name, order_expected_date, order_customer_phone, order_address1, order_address2, order_delivery_price from order_cm, (select @rownum :=0)as rowcolum]]>
 	 <![CDATA[order by order_no desc) as rownum_table where rnum >=#{startRow} and rnum <=#{endRow}]]>
 	
 	</select>
 	
 	<!-- 목록 갯수 카운트 -->
 	<select id = "ordercnt" parameterType = "customer" resultType = "int">
		select count(*) from order_cm where customer_no = #{customer_no} 	
 	</select>
 	<select id = "couponcnt" parameterType = "customer" resultType = "int">
		select count(*) from coupon_management where customer_no = #{customer_no} 	
 	</select>
 	<select id = "askcnt" parameterType = "customer" resultType = "int">
 		select count(*) from board_qna_cm where customer_no = #{customer_no}
 	</select>
 	
	<!-- 견적서 -->
    <select id="getMyEstimate" parameterType="estimate" resultType="estimate">
       select * from estimate_cm where customer_no = #{customer_no}
    </select>
    
    <select id="getAd_Estimate" parameterType="Ad_estimate" resultType="Ad_estimate">
       <![CDATA[ select ad.estimate_ad_no, ad.estimate_cm_no, ad.estimate_price, ad.estimate_reply_date, ad.estimate_type_content from estimate_ad ad, estimate_type t where ad.estimate_cm_no=#{estimate_cm_no} and ad.estimate_type_content = t.estimate_type_content; ]]>
    </select>
    
    <select id="getEstimateImg" resultType="estimate_image" parameterType="estimate_image">
       <![CDATA[ select * from estimate_image where estimate_cm_no=#{estimate_cm_no} and customer_no=#{customer_no} ]]>
    </select>
    
    <select id="getmyEstimate" parameterType="customer" resultType="estimate">
       select * from estimate_cm where customer_no=#{customer_no}
    </select>
    
 </mapper>
